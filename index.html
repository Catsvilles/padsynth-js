<html ng-app="synthApp">
<head>
	<title>Additive FM Synth</title>
	<link rel="stylesheet" type="text/css" href="synth.css">
</head>
<body>
	<p>
		MIDI Device: <select id="midiIn"></select>
		<input type="checkbox" id="analysis"><label for="analysis">Analysis</label>
		<button class="demo-button" data-idx="0">Demo 1</button>
		<button class="demo-button" data-idx="1">Demo 2</button>
	</p>
	<div class="canvasbox">
		<span class="canvas-title">Magnitude Spectrum</span>
		<canvas id="fftbox" width=1024 height=100></canvas>
<!--
		<span class="canvas-title">Bessel Spectrum</span>
		<canvas id="sidebands" width=1024 height=100></canvas>
-->
		<span class="canvas-title">Waveform</span>
		<canvas id="wavebox" width=1024 height=50></canvas>
	</div>
	<div ng-controller="ParamsCtrl">
		<div ng-controller="PresetCtrl as presetCtrl">
			Preset: <select ng-model="presetCtrl.selectedIndex" ng-change="presetCtrl.onChange()" ng-options="i as preset.name for (i, preset) in presetCtrl.presets"></select>
			<button ng-click="presetCtrl.save()">Save</button>
			<button ng-click="presetCtrl.reset()">Reset</button>
			<div class="param">
				<div class="param-label">Algorithm</div>
				<div class="param-value">{{ presetCtrl.presets[presetCtrl.selectedIndex].algorithm | number }}</div>
				<input type="range" step="1" min="1" max="32" to-number ng-model="presetCtrl.presets[presetCtrl.selectedIndex].algorithm">
			</div>
			<div class="param">
				<div class="param-label">Feedback</div>
				<div class="param-value">{{ presetCtrl.presets[presetCtrl.selectedIndex].feedback | number : 2 }}</div>
				<input type="range" step="1" min="0" max="7" to-number ng-model="presetCtrl.presets[presetCtrl.selectedIndex].feedback" ng-change="presetCtrl.onFeedbackChange()">
			</div>
			<div class="param-group" ng-repeat="(i, operator) in presetCtrl.presets[presetCtrl.selectedIndex].operators">
				<div class="group-name">OP {{ $index + 1 }}</div>

				<div ng-repeat="i in [1,2,3,4]">
					<div class="param">
						<div class="param-label">L{{ i }}</div>
						<div class="param-value">{{ operator['level' + i] | number : 0 }}</div>
						<input type="range" step="1" min="0" max="99" to-number ng-model="operator['level' + i]">
					</div>
					<div class="param">
						<div class="param-label">R{{ i }}</div>
						<div class="param-value">{{ operator['rate' + i] | number : 0 }}</div>
						<input type="range" step="1" min="0" max="99" to-number ng-model="operator['rate' + i]">
					</div>
				</div>
				<div class="param">
					<div class="param-label">Freq. Multiplier</div>
					<div class="param-value">{{ operator.freqMult | number : 1 }}</div>
					<input type="range" step="0.5" min="0.5" max="12" to-number ng-model="operator.freqMult">
				</div>
				<div class="param">
					<div class="param-label">Volume</div>
					<div class="param-value">{{ operator.volume | number : 0 }}</div>
					<input type="range" step="1" min="0" max="99" to-number ng-model="operator.volume" ng-change="presetCtrl.onVolumeChange(i, operator)">
				</div>
				<div class="param">
					<div class="param-label">Detune</div>
					<div class="param-value">{{ operator.detune | number : 0 }}</div>
					<input type="range" step="1" min="-50" max="50" to-number ng-model="operator.detune">
				</div>
			</div>
		</div>
	</div>
	<img src="algorithms.png" class="algo-diagram">
	<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular.js"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<script src="mml-emitter.min.js"></script>
	<script src="ngStorage.min.js"></script>
	<script src="app.js"></script>
	<script src="bessel.js"></script>
	<script src="spectrumBox.js"></script>
	<script src="envelope-dx7.js"></script>
	<script src="operator.js"></script>
	<script src="fmvoice.js"></script>
	<script src="additivefmvoice.js"></script>
	<script src="synth.js"></script>
	<script src="midi.js"></script>
	<script src="main.js"></script>
</body>
</html>